# vim:ft=sh

# Sentinel value to know we've loaded this file
export PROFILE_LOADED=1

# Use NeoVim if we have it
if command -v nvim > /dev/null; then
  VISUAL=nvim
else
  VISUAL=vim
fi
EDITOR=$VISUAL
export EDITOR VISUAL

# Tell ls to use colors by default (only works on Mac/BSD)
export CLICOLOR=1

# VirtualEnv {{{
# Centralized location for new virtual environments
export VIRTUAL_ENV_DEFAULT_DIR=$HOME/.local/virtualenv
# }}}

# Locally-installed packages belong in path
if ! echo ":$PATH:" | grep -q ":$HOME/.local/bin:"; then
  export PATH="$HOME/.local/bin:$PATH"
fi

# If available, we use git to list files from the root directory (not from the
# current directory as in other fzf cases). Otherwise, fallback to ag
export FZF_DEFAULT_COMMAND='(git ls-files -co --exclude-standard $(git rev-parse --show-toplevel) || ag -l -g "") 2> /dev/null'
export FZF_DEFAULT_OPTS="--extended"
export FZF_CTRL_T_COMMAND="$FZF_DEFAULT_COMMAND"

# Store config/cache files in default locations, but declare variables for use
# on platforms that don't (ahem, Mac OS)
export XDG_CACHE_HOME=$HOME/.cache
export XDG_CONFIG_HOME=$HOME/.config

# OS overrides
OS=`uname`
if [ "$OS" = "Darwin" ]; then
  if [ -f $HOME/.profile.osx ]; then
    . $HOME/.profile.osx
  fi
elif [ "$OS" = "Linux" ]; then
  if [ -f $HOME/.profile.linux ]; then
    . $HOME/.profile.linux
  fi
fi

# Local overrides if present
if [ -f $HOME/.profile.local ]; then
  . $HOME/.profile.local
fi
